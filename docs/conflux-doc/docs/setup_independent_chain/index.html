<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">setup_independent_chain | Conflux</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Conflux"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="#How to Set an Independent Conflux Chain"><meta data-react-helmet="true" property="og:description" content="#How to Set an Independent Conflux Chain"><meta data-react-helmet="true" property="og:url" content="https://devdoctest.conflux-chain.org/docs/conflux-doc/docs/setup_independent_chain">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.dfe3753f.css">


<link rel="preload" href="/styles.420a66b5.js" as="script">

<link rel="preload" href="/runtime~main.4df7ac6a.js" as="script">

<link rel="preload" href="/main.8c24596b.js" as="script">

<link rel="preload" href="/1.a4438468.js" as="script">

<link rel="preload" href="/2.7fc9b08f.js" as="script">

<link rel="preload" href="/3.860440fb.js" as="script">

<link rel="preload" href="/1be78505.bcb87f63.js" as="script">

<link rel="preload" href="/20ac7829.47057717.js" as="script">

<link rel="preload" href="/17896441.3878441d.js" as="script">

<link rel="preload" href="/b630c137.80ac9af9.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Conflux Logo"><strong class="navbar__title">Conflux Developer</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Conflux-Chain/conflux-developer-site">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Conflux Logo"><strong class="navbar__title">Conflux Developer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Conflux-Chain/conflux-developer-site">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">setup_independent_chain</h1></header><div class="markdown"><p>#How to Set an Independent Conflux Chain</p><p>You may want to run Conflux on a single node chain to develop and test smart
contracts. You can run Conflux as your indepdent chain with several machines.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="user-content-run-single-node-development-chain"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-content-run-single-node-development-chain" title="Direct link to heading">#</a>Run Single Node Development Chain</h2><p>In roder to run a single node Conflux chain for development, you can follow the
following steps:</p><ol><li><p>Get executable Conflux binary file (use precompiled binary or build from the
latest source code). You can refer to the document
<a href="https://conflux-chain.github.io/conflux-doc/install/">Installation</a>.</p></li><li><p>Create a directory and prepare a configuration file development.toml. You
can copy the default.toml provided in the directory and start from there
following the guide <a href="https://conflux-chain.github.io/conflux-doc/get_started/">Getting
Started</a>. </p></li><li><p>Set the bootnodes parameter in the configuration file to empty (or comment
the setting line).</p></li><li><p>Set the mode parameter to &quot;dev&quot;. If you copy from default.toml, you
should find the line being commented and you can uncomment it.</p></li><li><p>Set the dev_block_interval_ms parameter to the block generation interval
you want. In the development mode, Conflux will automatically generate a block
in a fixed interval.</p></li><li><p>Run Conflux binary with development.toml as the configuration file. For
example:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ../target/release/conflux --config development.toml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">``` </span></div></code></pre></div></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="user-content-run-multiple-node-production-chain"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-content-run-multiple-node-production-chain" title="Direct link to heading">#</a>Run Multiple Node Production Chain</h2><p>To have your independent Conflux chain with multiple nodes in the production
mode, you need to ensure that your nodes can be connected to other nodes in
this chain, and will not connect to other chains (like our testnet).</p><p>To achieve this, you should setup your own boot node, and let other nodes
connect to it. Then they will connect to others with our discovery protocol.</p><p>You need the IP address, the port number, and the node id of the bootnode for
others to connect. The node id is the public key corresponding the the node&#x27;s
unique private key for identification at the network layer. And here is an
instruction to let the bootnode generate its private key automatically, and get
the node id through the log file.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="user-content-a-simple-instruction"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-content-a-simple-instruction" title="Direct link to heading">#</a>A Simple Instruction</h2><ol><li><p>Get executable Conflux binary file (use precompiled binary or build from the
latest source code). You can refer to the document
<a href="https://conflux-chain.github.io/conflux-doc/install/">Installation</a>.</p></li><li><p>Create a directory and prepare a configuration file bootnode.toml for the
bootnode (the default port is 32323 if not set). You can refer to <a href="https://conflux-chain.github.io/conflux-doc/get_started/">Getting
Started</a>.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Ensure that `bootnode.toml` does not contain the `bootnode` entry, and the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">log level for `network` is at least `debug`. </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ mkdir run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ cd run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Put Conflux executable `conflux` and the configuration file `bootnode.toml` under `run`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">If you are editing based on our provided `default.toml`, you need to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">comment out the `bootnode` entry. Otherwise the node will connect to the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">existing Conflux net. </span></div></code></pre></div></li><li><p>Launch the bootnode, and find the node id in the console print out. The
information for node id is Self node id: $ID where $ID is the 0x-prefixed
node id of this bootnode. Remove the 0x prefix and you&#x27;ll get the node id
$NODEID. If you missed the line from the screen, you can look at the log file
with:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">grep &quot;Self node id&quot; log/conflux.log|awk &#x27;{print $9}&#x27;|tr -d &#x27;0x&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div></code></pre></div></li><li><p>Now we have the $IP, $PORT$, and $NODEID of the boot node, we can get
the url for this boot node with the format cfxnode://$NODEID@$IP:$PORT.
Denote this as $BOOTNODE_URL.</p></li><li><p>Start other nodes by setting bootnodes=&quot;$BOOTNODE_URL&quot; in their
configuration.</p></li></ol><p>Note that with the instruction above, other nodes connected to the boot node
will stay in untrusted state for a while (3 days by default), and untrusted
nodes will not be broadcast in our discovery protocol. Thus, the network
structure will be a star with the boot node in the center before other nodes
are promoted to trusted state. You can change node_table_promotion_timeout_s
in the configurations to make this period shorter.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="user-content-setting-multiple-bootnodes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-content-setting-multiple-bootnodes" title="Direct link to heading">#</a>Setting Multiple Bootnodes</h2><p>You can also setup multiple bootnodes at the very beginning. However, this
cannot be done by simply replaying the boot node setup steps above multiple
times, because you need to set bootnodes of every boot node before they are
started.</p><p>One way to achieve this is to start these bootnodes and stop them immediately.
Then gather their node ids, set their configuration, and restart them all.</p><p>Another better way is to generate their private keys seperately, and manually
set their net_key to start. This can be done with the functions provided in
our python test framework in the directory test.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">from conflux.utils import *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">num_of_bootnodes=10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">for _ in range(num_of_bootnodes):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pri_key, pub_key = ec_random_keys()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    node_id = encode_hex(encode_int32(pub_key[0]) + encode_int32(pub_key[1]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    print(encode_hex(pri_key), node_id)</span></div></code></pre></div><p>Then you can construct the bootnode url with the generated node id, and start
each node by setting the net_key=&quot;$NET_KEY&quot; field to the private key or pass
it with the command line option --net-key $NET_KEY.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="user-content-setting-genesis-accounts"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-content-setting-genesis-accounts" title="Direct link to heading">#</a>Setting Genesis Accounts</h2><p>In a production environment, you can initialize the initial genesis state with
your accounts by setting the genesis_accounts to an account file with formats
like</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">0f947e34fc907008968ec99baa1dbb677b927531=&quot;1000000000000&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ab4a32bca7500d94a2cc1f3150e12686c692c590=&quot;1000000000000&quot;</span></div></code></pre></div><p>Every line is an account. The key is the account address, and the value is a
string representing its balance in Drip. Note that genesis_accounts does not
apply if mode is test or dev.</p><p>If the mode is test or dev, you can setup the genesis accounts with their
secret keys by setting genesis_secrets. Each line is an account private key
without 0x-prefix. The balance of each account is set to
10000000000000000000000 by default.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Conflux-Chain/conflux-developer-site/edit/master/docs/conflux-doc/docs/setup_independent_chain.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-04-20T03:06:19.000Z" class="docLastUpdatedAt_1sqk">4/20/2020</time> by <strong>ConfluxBot</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/en/conflux_overview">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/conflux-portal/docs/en/portal/introduction">Portal</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://bounty.conflux-chain.org">Bounty</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Conflux-Chain">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/Conflux_Network">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Conflux Chain, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.420a66b5.js"></script>

<script src="/runtime~main.4df7ac6a.js"></script>

<script src="/main.8c24596b.js"></script>

<script src="/1.a4438468.js"></script>

<script src="/2.7fc9b08f.js"></script>

<script src="/3.860440fb.js"></script>

<script src="/1be78505.bcb87f63.js"></script>

<script src="/20ac7829.47057717.js"></script>

<script src="/17896441.3878441d.js"></script>

<script src="/b630c137.80ac9af9.js"></script>


</body>
</html>